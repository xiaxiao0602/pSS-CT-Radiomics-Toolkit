# 3D特征图可视化器

这个应用程序用于可视化医学影像的3D特征图和ROI（感兴趣区域）掩码，并提供参考示例对比功能。

## 功能特点

- 加载并可视化3D特征图和ROI掩码
- 通过下拉菜单选择不同的特征进行可视化
- 调整特征图的透明度（0.1-0.9）
- 提供阴性和阳性参考示例对比
- 交互式3D渲染，支持旋转、缩放和平移
- 智能缓存机制，提高参考示例加载速度
- 颜色映射图例显示
- 坐标轴标注（单位：mm）

## 安装说明

本程序包含独立的Python环境，无需系统安装Python即可运行。首次使用时，请按以下步骤操作：

1. 下载并解压本程序包
2. 双击运行`setup.bat`，等待环境配置完成
   - 此过程将下载便携版Python 3.9.13
   - 自动安装所需的所有依赖包
   - 首次安装可能需要几分钟时间

## 运行程序

完成安装后，启动程序的方法：

1. 双击运行`start.bat`即可启动程序
   - 无需配置任何环境变量
   - 所有依赖都在程序目录中

## 使用说明

1. 程序启动后，点击"选择特征图文件夹"按钮，选择包含特征图和ROI掩码的文件夹：
   - 文件夹中必须包含一个名为`mask.nii.gz`的ROI掩码文件
   - 其他`.nii`或`.nii.gz`文件将被视为特征图文件

2. 使用左侧控制面板：
   - 从下拉菜单中选择要可视化的特征
   - 调整透明度下拉框来改变特征图的可见度
   - 查看特征预测方向说明，了解不同特征的预测倾向
   - 观察阴性和阳性参考示例，进行对比分析

3. 在3D视图窗口中：
   - 使用鼠标左键旋转模型
   - 使用鼠标右键或滚轮缩放
   - 使用鼠标中键平移视图

## 参考示例设置

程序需要在运行目录下包含`reference_examples`文件夹，其结构如下：

```
reference_examples/
├── negative/
│   ├── feature1.nii.gz
│   ├── feature2.nii.gz
│   └── mask.nii.gz
└── positive/
    ├── feature1.nii.gz
    ├── feature2.nii.gz
    └── mask.nii.gz
```

- `negative`文件夹：存放阴性参考示例
- `positive`文件夹：存放阳性参考示例
- 每个文件夹必须包含对应的`mask.nii.gz`文件
- 特征文件名必须与主窗口中显示的特征名称相匹配

## 特征预测方向说明

- 高值指向阴性的特征：
  - square_glcm_MaximumProbability

- 高值指向阳性的特征：
  - square_glcm_DifferenceAverage
  - square_glrlm_RunPercentage
  - square_glrlm_ShortRunEmphasis

## 文件要求

- 特征图文件：必须是`.nii`或`.nii.gz`格式
- ROI掩码文件：必须是`mask.nii.gz`
- 所有文件必须具有相同的维度和物理空间位置
- 参考示例文件必须与主特征文件具有相同的命名规则

## 故障排除

如果程序无法启动或运行出错，请检查：

1. 是否已运行`setup.bat`完成环境配置
2. 文件夹结构是否正确
3. 参考示例文件名是否与特征文件名匹配
4. 所有文件格式是否正确

如果问题仍然存在，请尝试重新运行`setup.bat`重置环境。 